<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root{
      --bg:#f6f8fc;
      --card:#ffffff;
      --text:#0b1220;
      --muted:#50627a;
      --border:#d9e2ef;
      --accent:#0284c7;
      --shadow: 0 10px 30px rgba(2,8,23,.08);
    }
    @media (prefers-color-scheme: dark){
      :root{
        --bg:#0b0f14;
        --card:#0f1621;
        --text:#e7eef7;
        --muted:#9fb0c3;
        --border:#223042;
        --accent:#7dd3fc;
        --shadow: 0 10px 30px rgba(0,0,0,.35);
      }
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      background:var(--bg);
      color:var(--text);
      padding:20px;
    }
    .page{
      max-width:900px;
      margin:0 auto;
      background:var(--card);
      padding:18px;
      border-radius:16px;
      border:1px solid var(--border);
      box-shadow:var(--shadow);
    }
    header h1{margin:0;font-size:1.25rem}
    header .subtitle{margin:.25rem 0 0;color:var(--muted)}
    .switcher{
      display:flex;
      gap:8px;
      margin:16px 0 12px;
      flex-wrap:wrap;
    }
    .switcher button{
      border:1px solid var(--border);
      background:transparent;
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      font-weight:650;
    }
    .switcher button.active{
      border-color:color-mix(in srgb, var(--accent) 60%, var(--border));
      background:color-mix(in srgb, var(--accent) 12%, transparent);
    }
    form{
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    label{
      display:flex;
      flex-direction:column;
      gap:6px;
      font-weight:650;
      color:var(--muted);
      font-size:.92rem;
    }
    input, select, textarea{
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--border);
      background:#fff;
      color:#0b1220;
      font-size:1rem;
    }
    @media (prefers-color-scheme: dark){
      input, select, textarea{
        background:#0b0f14;
        color:var(--text);
      }
    }
    textarea{min-height:90px}
    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .row > *{flex:1}
    .authors{
      border:1px solid var(--border);
      padding:12px;
      border-radius:12px;
      background:#fff;
    }
    @media (prefers-color-scheme: dark){
      .authors{background:#0b0f14}
    }
    .authors h3{
      margin:0 0 10px;
      font-size:1rem;
      color:var(--text);
      font-weight:800;
    }
    .authors .author{
      display:grid;
      grid-template-columns: 1fr 1fr auto;
      gap:8px;
      margin-bottom:8px;
      align-items:center;
    }
    .authors .author input{
      width:100%;
    }
    .authors .author button{
      border:1px solid var(--border);
      background:transparent;
      color:var(--text);
      padding:8px 10px;
      border-radius:10px;
      cursor:pointer;
      font-weight:700;
    }
    .authors .actions{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top:6px;
    }
    .authors .actions button{
      border:1px solid var(--border);
      background:transparent;
      color:var(--text);
      padding:9px 11px;
      border-radius:12px;
      cursor:pointer;
      font-weight:700;
    }
    .hint{
      margin:0 0 12px;
      color:var(--muted);
      font-size:.9rem;
    }
    .status{
      margin-top:8px;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--border);
      background:color-mix(in srgb, var(--accent) 10%, transparent);
      color:var(--text);
      font-size:.92rem;
      white-space:pre-wrap;
    }
    .status.ok{
      border-color:color-mix(in srgb, #34d399 40%, var(--border));
      background:color-mix(in srgb, #34d399 12%, transparent);
    }
    .status.err{
      border-color:color-mix(in srgb, #fb7185 40%, var(--border));
      background:color-mix(in srgb, #fb7185 12%, transparent);
    }
    .actions-bottom{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
      align-items:center;
    }
    .actions-bottom button{
      border:1px solid var(--border);
      background:transparent;
      color:var(--text);
      padding:11px 13px;
      border-radius:12px;
      cursor:pointer;
      font-weight:750;
    }
    .actions-bottom button.primary{
      border-color:color-mix(in srgb, var(--accent) 60%, var(--border));
      background:color-mix(in srgb, var(--accent) 14%, transparent);
    }
    .check{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:6px 10px;
      border:1px solid var(--border);
      border-radius:999px;
      background:#fff;
      font-weight:600;
      font-size:.85rem;
      cursor:pointer;
      user-select:none;
    }
    .check input{
      width:16px;height:16px;
      margin:0;
    }
    @media (prefers-color-scheme: dark){
      .check{background:#0b0f14}
    }
    footer{margin-top:18px;color:var(--muted);font-size:.8rem}
  </style>
</head>

<body>
  <div class="page">
    <header>
  <h1>DÃ©clarations du laboratoire</h1>
  <p class="subtitle">Les donnÃ©es sont envoyÃ©es automatiquement dans Zotero.</p>

  <p style="margin-top:8px;font-size:.9rem">
    ðŸ“Š
    <a href="/suivi.html" target="_blank" rel="noopener noreferrer"
       style="color:var(--accent);text-decoration:none;font-weight:600">
      Voir le suivi public des demandes (HAL & communication)
    </a>
  </p>

  <p style="margin-top:6px;font-size:.9rem">
    ðŸ§¾
    <a href="/cv.html" target="_blank" rel="noopener noreferrer"
       style="color:var(--accent);text-decoration:none;font-weight:600">
      GÃ©nÃ©rateur de CV (Ã  partir des publications Zotero)
    </a>
  </p>

  <p style="margin-top:6px;font-size:.9rem">
    ðŸ“¥
    <a href="/import.html"
       style="color:var(--accent);text-decoration:none;font-weight:600">
      Import par lot (CSV HAL â†’ Zotero)
    </a>
  </p>
</header>


    <div class="switcher">
      <button type="button" class="active">Nouvelle publication</button>
    </div>

    <p class="hint">Choisissez le type (Livre / Chapitre / Article), puis remplissez les champs requis.</p>

    <form id="pub-form">
      <label>
        <span>Type de publication *</span>
        <select name="pubType" id="pubType">
          <option value="book">Livre</option>
          <option value="bookSection">Chapitre dâ€™ouvrage</option>
          <option value="journalArticle">Article (revue)</option>
        </select>
      </label>

      <label>
        <span>Titre *</span>
        <input name="title" id="title" placeholder="Titre complet" required>
      </label>

      <div class="authors">
        <h3>Auteurs *</h3>
        <div id="authors-list"></div>
        <div class="actions">
          <button type="button" id="add-author">+ Ajouter un auteur</button>
        </div>
      </div>

      <div class="row">
        <label>
          <span>Date *</span>
          <input name="date" id="date" placeholder="ex: 2024-05-12 ou 2024" required>
        </label>

        <label>
          <span>Langue</span>
          <input name="language" id="language" placeholder="fr / en / ...">
        </label>
      </div>

      <div id="book-fields">
        <div class="row">
          <label>
            <span>Ã‰diteur *</span>
            <input name="publisher" id="publisher" placeholder="ex: Presses de ..." required>
          </label>
          <label>
            <span>Lieu *</span>
            <input name="place" id="place" placeholder="ex: Paris" required>
          </label>
        </div>

        <div class="row">
          <label>
            <span>Collection</span>
            <input name="series" id="series" placeholder="ex: Collection X">
          </label>
          <label>
            <span>NÂ° collection</span>
            <input name="seriesNumber" id="seriesNumber" placeholder="ex: 12">
          </label>
        </div>

        <div class="row">
          <label>
            <span>Volume</span>
            <input name="volume" id="volume" placeholder="ex: 1">
          </label>
          <label>
            <span>Ã‰dition</span>
            <input name="edition" id="edition" placeholder="ex: 2e Ã©d.">
          </label>
        </div>

        <div class="row">
          <label>
            <span>Pages</span>
            <input name="pages" id="pages" placeholder="ex: 250">
          </label>
          <label>
            <span>ISBN</span>
            <input name="isbn" id="isbn" placeholder="ex: 978...">
          </label>
        </div>

        <label>
          <span>RÃ©sumÃ©</span>
          <textarea name="abstract" id="abstract" placeholder="RÃ©sumÃ© (facultatif)"></textarea>
        </label>
      </div>

      <div id="section-fields" style="display:none">
        <label>
          <span>Titre de lâ€™ouvrage *</span>
          <input name="bookTitle" id="bookTitle" placeholder="Titre de lâ€™ouvrage" required>
        </label>

        <div class="row">
          <label>
            <span>Ã‰diteur *</span>
            <input name="publisher_section" id="publisher_section" placeholder="ex: Presses de ..." required>
          </label>
          <label>
            <span>Lieu *</span>
            <input name="place_section" id="place_section" placeholder="ex: Paris" required>
          </label>
        </div>

        <div class="row">
          <label>
            <span>Collection</span>
            <input name="series_section" id="series_section" placeholder="ex: Collection X">
          </label>
          <label>
            <span>NÂ° collection</span>
            <input name="seriesNumber_section" id="seriesNumber_section" placeholder="ex: 12">
          </label>
        </div>

        <div class="row">
          <label>
            <span>Volume</span>
            <input name="volume_section" id="volume_section" placeholder="ex: 1">
          </label>
          <label>
            <span>Ã‰dition</span>
            <input name="edition_section" id="edition_section" placeholder="ex: 2e Ã©d.">
          </label>
        </div>

        <div class="row">
          <label>
            <span>Pages</span>
            <input name="pages_section" id="pages_section" placeholder="ex: 101-120">
          </label>
          <label>
            <span>ISBN</span>
            <input name="isbn_section" id="isbn_section" placeholder="ex: 978...">
          </label>
        </div>

        <label>
          <span>RÃ©sumÃ©</span>
          <textarea name="abstract_section" id="abstract_section" placeholder="RÃ©sumÃ© (facultatif)"></textarea>
        </label>
      </div>

      <div id="article-fields" style="display:none">
        <label>
          <span>Revue *</span>
          <input name="publication" id="publication" placeholder="Titre de la revue" required>
        </label>

        <div class="row">
          <label>
            <span>Volume</span>
            <input name="articleVolume" id="articleVolume" placeholder="ex: 12">
          </label>
          <label>
            <span>NumÃ©ro</span>
            <input name="articleIssue" id="articleIssue" placeholder="ex: 3">
          </label>
        </div>

        <div class="row">
          <label>
            <span>Pages</span>
            <input name="articlePages" id="articlePages" placeholder="ex: 45-60">
          </label>
          <label>
            <span>DOI</span>
            <input name="doi" id="doi" placeholder="ex: 10.xxxx/xxxxx">
          </label>
        </div>

        <label>
          <span>Ã‰diteur (optionnel)</span>
          <input name="publisher_article" id="publisher_article" placeholder="(facultatif)">
        </label>

        <label>
          <span>Lieu (optionnel)</span>
          <input name="place_article" id="place_article" placeholder="(facultatif)">
        </label>

        <label>
          <span>RÃ©sumÃ©</span>
          <textarea name="abstract_article" id="abstract_article" placeholder="RÃ©sumÃ© (facultatif)"></textarea>
        </label>
      </div>

      <label>
        <span>Extra (facultatif)</span>
        <textarea name="extra" id="extra" placeholder="Infos complÃ©mentaires (facultatif)"></textarea>
      </label>

      <div class="actions-bottom">
        <button type="submit" class="primary">Envoyer dans Zotero</button>
        <span class="check"><input type="checkbox" id="auto-doi"> <span>PrÃ©remplir via DOI</span></span>
      </div>

      <div id="status" class="status" style="display:none"></div>
    </form>

    <footer>
      Version publique â€” projet interne au laboratoire.
    </footer>
  </div>

  <script src="/assets/app.js"></script>

  <script>
    // Petit helper : si le site est derriÃ¨re un sous-chemin (rare sur Netlify),
    // on force les liens absolus Ã  marcher.
    (function(){
      const base = document.querySelector('base');
      if(!base){
        // no-op
      }
    })();
  </script>

</body>
</html>
